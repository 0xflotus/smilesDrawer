<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Atom.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ArrayHelper.html">ArrayHelper</a><ul class='methods'><li data-type='method'><a href="ArrayHelper.html#.clone">clone</a></li><li data-type='method'><a href="ArrayHelper.html#.contains">contains</a></li><li data-type='method'><a href="ArrayHelper.html#.containsAll">containsAll</a></li><li data-type='method'><a href="ArrayHelper.html#.count">count</a></li><li data-type='method'><a href="ArrayHelper.html#.each">each</a></li><li data-type='method'><a href="ArrayHelper.html#.get">get</a></li><li data-type='method'><a href="ArrayHelper.html#.intersection">intersection</a></li><li data-type='method'><a href="ArrayHelper.html#.merge">merge</a></li><li data-type='method'><a href="ArrayHelper.html#.print">print</a></li><li data-type='method'><a href="ArrayHelper.html#.remove">remove</a></li><li data-type='method'><a href="ArrayHelper.html#.removeAll">removeAll</a></li><li data-type='method'><a href="ArrayHelper.html#.toggle">toggle</a></li><li data-type='method'><a href="ArrayHelper.html#.unique">unique</a></li></ul></li><li><a href="Atom.html">Atom</a><ul class='methods'><li data-type='method'><a href="Atom.html#addAnchoredRing">addAnchoredRing</a></li><li data-type='method'><a href="Atom.html#canRotate">canRotate</a></li><li data-type='method'><a href="Atom.html#getMaxRingbond">getMaxRingbond</a></li><li data-type='method'><a href="Atom.html#getRingbondCount">getRingbondCount</a></li><li data-type='method'><a href="Atom.html#hasRing">hasRing</a></li><li data-type='method'><a href="Atom.html#hasRingbonds">hasRingbonds</a></li><li data-type='method'><a href="Atom.html#haveCommonRingbond">haveCommonRingbond</a></li><li data-type='method'><a href="Atom.html#maxCommonRingbond">maxCommonRingbond</a></li></ul></li><li><a href="CanvasWrapper.html">CanvasWrapper</a><ul class='methods'><li data-type='method'><a href="CanvasWrapper.html#clear">clear</a></li><li data-type='method'><a href="CanvasWrapper.html#drawAromaticityRing">drawAromaticityRing</a></li><li data-type='method'><a href="CanvasWrapper.html#drawCircle">drawCircle</a></li><li data-type='method'><a href="CanvasWrapper.html#drawDebugPoint">drawDebugPoint</a></li><li data-type='method'><a href="CanvasWrapper.html#drawDebugText">drawDebugText</a></li><li data-type='method'><a href="CanvasWrapper.html#drawLine">drawLine</a></li><li data-type='method'><a href="CanvasWrapper.html#drawText">drawText</a></li><li data-type='method'><a href="CanvasWrapper.html#getColor">getColor</a></li><li data-type='method'><a href="CanvasWrapper.html#reset">reset</a></li><li data-type='method'><a href="CanvasWrapper.html#scale">scale</a></li><li data-type='method'><a href="CanvasWrapper.html#setTheme">setTheme</a></li></ul></li><li><a href="Edge.html">Edge</a><ul class='methods'><li data-type='method'><a href="Edge.html#getBondCount">getBondCount</a></li></ul></li><li><a href="Line.html">Line</a><ul class='methods'><li data-type='method'><a href="Line.html#clone">clone</a></li><li data-type='method'><a href="Line.html#getAngle">getAngle</a></li><li data-type='method'><a href="Line.html#getLeftElement">getLeftElement</a></li><li data-type='method'><a href="Line.html#getLeftVector">getLeftVector</a></li><li data-type='method'><a href="Line.html#getLength">getLength</a></li><li data-type='method'><a href="Line.html#getRightElement">getRightElement</a></li><li data-type='method'><a href="Line.html#getRightVector">getRightVector</a></li><li data-type='method'><a href="Line.html#rotate">rotate</a></li><li data-type='method'><a href="Line.html#rotateToXAxis">rotateToXAxis</a></li><li data-type='method'><a href="Line.html#setLeftVector">setLeftVector</a></li><li data-type='method'><a href="Line.html#setRightVector">setRightVector</a></li><li data-type='method'><a href="Line.html#shorten">shorten</a></li><li data-type='method'><a href="Line.html#shortenFrom">shortenFrom</a></li><li data-type='method'><a href="Line.html#shortenTo">shortenTo</a></li></ul></li><li><a href="MathHelper.html">MathHelper</a><ul class='methods'><li data-type='method'><a href="MathHelper.html#.apothem">apothem</a></li><li data-type='method'><a href="MathHelper.html#.centralAngle">centralAngle</a></li><li data-type='method'><a href="MathHelper.html#.innerAngle">innerAngle</a></li><li data-type='method'><a href="MathHelper.html#.meanAngle">meanAngle</a></li><li data-type='method'><a href="MathHelper.html#.polyCircumradius">polyCircumradius</a></li><li data-type='method'><a href="MathHelper.html#.round">round</a></li><li data-type='method'><a href="MathHelper.html#.toDeg">toDeg</a></li><li data-type='method'><a href="MathHelper.html#.toRad">toRad</a></li></ul></li><li><a href="Pair.html">Pair</a><ul class='methods'><li data-type='method'><a href="Pair.html#.createUniquePairs">createUniquePairs</a></li><li data-type='method'><a href="Pair.html#contains">contains</a></li><li data-type='method'><a href="Pair.html#getHash">getHash</a></li></ul></li><li><a href="Ring.html">Ring</a><ul class='methods'><li data-type='method'><a href="Ring.html#.getRing">getRing</a></li><li data-type='method'><a href="Ring.html#allowsFlip">allowsFlip</a></li><li data-type='method'><a href="Ring.html#clone">clone</a></li><li data-type='method'><a href="Ring.html#contains">contains</a></li><li data-type='method'><a href="Ring.html#eachMember">eachMember</a></li><li data-type='method'><a href="Ring.html#getAngle">getAngle</a></li><li data-type='method'><a href="Ring.html#getOrderedNeighbours">getOrderedNeighbours</a></li><li data-type='method'><a href="Ring.html#getPolygon">getPolygon</a></li><li data-type='method'><a href="Ring.html#getSize">getSize</a></li><li data-type='method'><a href="Ring.html#hasSource">hasSource</a></li><li data-type='method'><a href="Ring.html#hasSourceAndTarget">hasSourceAndTarget</a></li><li data-type='method'><a href="Ring.html#hasTarget">hasTarget</a></li><li data-type='method'><a href="Ring.html#isAromatic">isAromatic</a></li><li data-type='method'><a href="Ring.html#setFlipped">setFlipped</a></li><li data-type='method'><a href="Ring.html#thisOrNeighboursContain">thisOrNeighboursContain</a></li></ul></li><li><a href="RingConnection.html">RingConnection</a><ul class='methods'><li data-type='method'><a href="RingConnection.html#.getNeighbours">getNeighbours</a></li><li data-type='method'><a href="RingConnection.html#.getVertices">getVertices</a></li><li data-type='method'><a href="RingConnection.html#.isBridge">isBridge</a></li><li data-type='method'><a href="RingConnection.html#addVertex">addVertex</a></li><li data-type='method'><a href="RingConnection.html#isBridge">isBridge</a></li><li data-type='method'><a href="RingConnection.html#updateOther">updateOther</a></li></ul></li><li><a href="SmilesDrawer.html">SmilesDrawer</a><ul class='methods'><li data-type='method'><a href="SmilesDrawer.html#addEdge">addEdge</a></li><li data-type='method'><a href="SmilesDrawer.html#addRing">addRing</a></li><li data-type='method'><a href="SmilesDrawer.html#addRingConnection">addRingConnection</a></li><li data-type='method'><a href="SmilesDrawer.html#addVertex">addVertex</a></li><li data-type='method'><a href="SmilesDrawer.html#areConnected">areConnected</a></li><li data-type='method'><a href="SmilesDrawer.html#areVerticesInSameRing">areVerticesInSameRing</a></li><li data-type='method'><a href="SmilesDrawer.html#chooseSide">chooseSide</a></li><li data-type='method'><a href="SmilesDrawer.html#clearPositions">clearPositions</a></li><li data-type='method'><a href="SmilesDrawer.html#createBridgedRing">createBridgedRing</a></li><li data-type='method'><a href="SmilesDrawer.html#createNextBond">createNextBond</a></li><li data-type='method'><a href="SmilesDrawer.html#createRing">createRing</a></li><li data-type='method'><a href="SmilesDrawer.html#dijkstra">dijkstra</a></li><li data-type='method'><a href="SmilesDrawer.html#draw">draw</a></li><li data-type='method'><a href="SmilesDrawer.html#drawEdges">drawEdges</a></li><li data-type='method'><a href="SmilesDrawer.html#drawVertices">drawVertices</a></li><li data-type='method'><a href="SmilesDrawer.html#edgeRingCount">edgeRingCount</a></li><li data-type='method'><a href="SmilesDrawer.html#extend">extend</a></li><li data-type='method'><a href="SmilesDrawer.html#forceLayout">forceLayout</a></li><li data-type='method'><a href="SmilesDrawer.html#getBondCount">getBondCount</a></li><li data-type='method'><a href="SmilesDrawer.html#getBranch">getBranch</a></li><li data-type='method'><a href="SmilesDrawer.html#getBridgedRingRings">getBridgedRingRings</a></li><li data-type='method'><a href="SmilesDrawer.html#getBridgedRings">getBridgedRings</a></li><li data-type='method'><a href="SmilesDrawer.html#getCommonRingbondNeighbour">getCommonRingbondNeighbour</a></li><li data-type='method'><a href="SmilesDrawer.html#getCommonRings">getCommonRings</a></li><li data-type='method'><a href="SmilesDrawer.html#getEdge">getEdge</a></li><li data-type='method'><a href="SmilesDrawer.html#getEdgeNormals">getEdgeNormals</a></li><li data-type='method'><a href="SmilesDrawer.html#getEdgeWeight">getEdgeWeight</a></li><li data-type='method'><a href="SmilesDrawer.html#getFusedRings">getFusedRings</a></li><li data-type='method'><a href="SmilesDrawer.html#getHeavyAtomCount">getHeavyAtomCount</a></li><li data-type='method'><a href="SmilesDrawer.html#getLargestCommonRing">getLargestCommonRing</a></li><li data-type='method'><a href="SmilesDrawer.html#getMinDist">getMinDist</a></li><li data-type='method'><a href="SmilesDrawer.html#getNonRingNeighbours">getNonRingNeighbours</a></li><li data-type='method'><a href="SmilesDrawer.html#getOverlapScore">getOverlapScore</a></li><li data-type='method'><a href="SmilesDrawer.html#getRing">getRing</a></li><li data-type='method'><a href="SmilesDrawer.html#getRingbondType">getRingbondType</a></li><li data-type='method'><a href="SmilesDrawer.html#getRingConnections">getRingConnections</a></li><li data-type='method'><a href="SmilesDrawer.html#getRingCount">getRingCount</a></li><li data-type='method'><a href="SmilesDrawer.html#getRingVertices">getRingVertices</a></li><li data-type='method'><a href="SmilesDrawer.html#getSmallestCommonRing">getSmallestCommonRing</a></li><li data-type='method'><a href="SmilesDrawer.html#getSpiros">getSpiros</a></li><li data-type='method'><a href="SmilesDrawer.html#getSubringCenter">getSubringCenter</a></li><li data-type='method'><a href="SmilesDrawer.html#getTotalOverlapScore">getTotalOverlapScore</a></li><li data-type='method'><a href="SmilesDrawer.html#getTreeDepth">getTreeDepth</a></li><li data-type='method'><a href="SmilesDrawer.html#getVerticesAt">getVerticesAt</a></li><li data-type='method'><a href="SmilesDrawer.html#hasBridgedRing">hasBridgedRing</a></li><li data-type='method'><a href="SmilesDrawer.html#initGraph">initGraph</a></li><li data-type='method'><a href="SmilesDrawer.html#initRings">initRings</a></li><li data-type='method'><a href="SmilesDrawer.html#isEdgeInAromaticRing">isEdgeInAromaticRing</a></li><li data-type='method'><a href="SmilesDrawer.html#isEdgeInRing">isEdgeInRing</a></li><li data-type='method'><a href="SmilesDrawer.html#isPartOfBridgedRing">isPartOfBridgedRing</a></li><li data-type='method'><a href="SmilesDrawer.html#isPointInRing">isPointInRing</a></li><li data-type='method'><a href="SmilesDrawer.html#isRingAromatic">isRingAromatic</a></li><li data-type='method'><a href="SmilesDrawer.html#isVertexInAromaticRing">isVertexInAromaticRing</a></li><li data-type='method'><a href="SmilesDrawer.html#position">position</a></li><li data-type='method'><a href="SmilesDrawer.html#printRingInfo">printRingInfo</a></li><li data-type='method'><a href="SmilesDrawer.html#removeRing">removeRing</a></li><li data-type='method'><a href="SmilesDrawer.html#removeRingConnection">removeRingConnection</a></li><li data-type='method'><a href="SmilesDrawer.html#removeRingConnectionsBetween">removeRingConnectionsBetween</a></li><li data-type='method'><a href="SmilesDrawer.html#resolvePrimaryOverlaps">resolvePrimaryOverlaps</a></li><li data-type='method'><a href="SmilesDrawer.html#resolveSecondaryOverlaps">resolveSecondaryOverlaps</a></li><li data-type='method'><a href="SmilesDrawer.html#restorePositions">restorePositions</a></li><li data-type='method'><a href="SmilesDrawer.html#rotateSubtree">rotateSubtree</a></li><li data-type='method'><a href="SmilesDrawer.html#traverseTree">traverseTree</a></li></ul></li><li><a href="Vector2.html">Vector2</a><ul class='methods'><li data-type='method'><a href="Vector2.html#add">add</a></li><li data-type='method'><a href="Vector2.html#angle">angle</a></li><li data-type='method'><a href="Vector2.html#clockwise">clockwise</a></li><li data-type='method'><a href="Vector2.html#clone">clone</a></li><li data-type='method'><a href="Vector2.html#distance">distance</a></li><li data-type='method'><a href="Vector2.html#distanceSq">distanceSq</a></li><li data-type='method'><a href="Vector2.html#divide">divide</a></li><li data-type='method'><a href="Vector2.html#getRotateToAngle">getRotateToAngle</a></li><li data-type='method'><a href="Vector2.html#invert">invert</a></li><li data-type='method'><a href="Vector2.html#isInPolygon">isInPolygon</a></li><li data-type='method'><a href="Vector2.html#length">length</a></li><li data-type='method'><a href="Vector2.html#multiply">multiply</a></li><li data-type='method'><a href="Vector2.html#normalize">normalize</a></li><li data-type='method'><a href="Vector2.html#normalized">normalized</a></li><li data-type='method'><a href="Vector2.html#rotate">rotate</a></li><li data-type='method'><a href="Vector2.html#rotateAround">rotateAround</a></li><li data-type='method'><a href="Vector2.html#rotateTo">rotateTo</a></li><li data-type='method'><a href="Vector2.html#sameSideAs">sameSideAs</a></li><li data-type='method'><a href="Vector2.html#set">set</a></li><li data-type='method'><a href="Vector2.html#subtract">subtract</a></li><li data-type='method'><a href="Vector2.html#toString">toString</a></li><li data-type='method'><a href="Vector2.html#whichSide">whichSide</a></li><li data-type='method'><a href="Vector2.html#.add">add</a></li><li data-type='method'><a href="Vector2.html#.angle">angle</a></li><li data-type='method'><a href="Vector2.html#.divide">divide</a></li><li data-type='method'><a href="Vector2.html#.dot">dot</a></li><li data-type='method'><a href="Vector2.html#.midpoint">midpoint</a></li><li data-type='method'><a href="Vector2.html#.multiply">multiply</a></li><li data-type='method'><a href="Vector2.html#.normals">normals</a></li><li data-type='method'><a href="Vector2.html#.scalarProjection">scalarProjection</a></li><li data-type='method'><a href="Vector2.html#.subtract">subtract</a></li></ul></li><li><a href="Vertex.html">Vertex</a><ul class='methods'><li data-type='method'><a href="Vertex.html#clone">clone</a></li><li data-type='method'><a href="Vertex.html#equals">equals</a></li><li data-type='method'><a href="Vertex.html#getAngle">getAngle</a></li><li data-type='method'><a href="Vertex.html#getCommonNeighbours">getCommonNeighbours</a></li><li data-type='method'><a href="Vertex.html#getNeighbours">getNeighbours</a></li><li data-type='method'><a href="Vertex.html#getNextInRing">getNextInRing</a></li><li data-type='method'><a href="Vertex.html#getSpanningTreeNeighbours">getSpanningTreeNeighbours</a></li><li data-type='method'><a href="Vertex.html#getTextDirection">getTextDirection</a></li><li data-type='method'><a href="Vertex.html#isNeighbour">isNeighbour</a></li><li data-type='method'><a href="Vertex.html#isTerminal">isTerminal</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">Atom.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** A class representing an atom */
class Atom {
    /**
     * The constructor of the class Atom.
     *
     * @param {string} element The one-letter code of the element.
     * @param {string} [bondType='-'] The type of the bond associated with this atom.
     */
    constructor(element, bondType = '-') {
        this.element = element;
        this.explicit = false;
        this.ringbonds = new Array();
        this.rings = new Array();
        this.bondType = bondType;
        this.isTerminal = false;
        this.isBridge = false;
        this.isBridgeNode = false;
        this.bridgedRing = null;
        this.anchoredRings = new Array();
        this.bracket = null;
    }

    /**
     * Defines this atom as the anchor for a ring. When doing repositionings of the vertices and the vertex associated with this atom is moved, the center of this ring is moved as well.
     *
     * @param {number} ringId A ring id.
     */
    addAnchoredRing(ringId) {
        if (!ArrayHelper.contains(this.anchoredRings, { value: ringId })) {
            this.anchoredRings.push(ringId);
        }
    }

    /**
     * Returns the number of ringbonds (breaks in rings to generate the MST of the smiles) within this atom is connected to.
     *
     * @returns {number} The number of ringbonds this atom is connected to.
     */
    getRingbondCount() {
        return this.ringbonds.length;
    }

    /**
     * Check whether or not this atom is rotatable. The atom is deemed rotatable if it is neither a member of a ring nor participating in a bond other than a single bond. TODO: Check the chemistry.
     *
     * @returns {boolean} A boolean indicating whether or not this atom is rotatable.
     */
    canRotate() {
        return this.bondType === '-' &amp;&amp; this.rings.length == 0;
    }

    /**
     * Returns whether or not this atom participates in ringbonds (breaks in the ring in the MST).
     *
     * @returns {boolean} A boolean indicating whether or not this atom is associated with a ringbond.
     */
    hasRingbonds() {
        return this.ringbonds.length > 0;
    }

    /**
     * Returns the id of the ringbond with the highest id.
     *
     * @returns {number} The highest ringbond id associated with this atom.
     */
    getMaxRingbond() {
        let max = 0;
        for (let i = 0; i &lt; this.ringbonds.length; i++) {
            if (this.ringbonds[i].id > max) {
                max = this.ringbonds[i].id
            }
        }
 
        return max;
    }

    /**
     * Checks whether or not this atom is a member of a given ring.
     *
     * @param {number} ringId A ring id.
     * @returns {boolean} A boolean indicating whether or not this atom is a member of a given ring.
     */
    hasRing(ringId) {
        for (let i = 0; i &lt; this.rings; i++) {
            if (ringId === this.rings[i]) {
                return true;
            }
        }

        return false;
    }

    /**
     * Checks whether or not two atoms share a common ringbond id. A ringbond is a break in a ring created when generating the spanning tree of a structure.
     *
     * @param {Atom} atomA An atom.
     * @param {Atom} atomB An atom.
     * @returns {boolean} A boolean indicating whether or not two atoms share a common ringbond.
     */
    haveCommonRingbond(atomA, atomB) {
        for (let i = 0; i &lt; atomA.ringbonds.length; i++) {
            for (let j = 0; j &lt; atomB.ringbonds.length; j++) {
                if (atomA.ringbonds[i].id == atomB.ringbonds[j].id) {
                    return true;
                }
            }
        }

        return false;
    }

    /**
     * Get the highest numbered ringbond shared by two atoms. A ringbond is a break in a ring created when generating the spanning tree of a structure.
     *
     * @param {Atom} atomA An atom.
     * @param {Atom} atomB An atom.
     * @returns {number} The number of the maximum ringbond shared by two atoms.
     */
    maxCommonRingbond(atomA, atomB) {
        let commonMax = 0;
        let maxA = 0;
        let maxB = 0;

        for (let i = 0; i &lt; atomA.ringbonds.length; i++) {
            if (atomA.ringbonds[i].id > maxA) {
                maxA = atomA.ringbonds[i].id;
            }

            for (let j = 0; j &lt; atomB.ringbonds.length; j++) {
                if (atomB.ringbonds[j].id > maxB) {
                    maxB = atomB.ringbonds[j].id;
                } else if (maxA == maxB) {
                    commonMax = maxA;
                }
            }
        }

        return commonMax;
    }
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Wed Mar 15 2017 20:27:39 GMT+0100 (W. Europe Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>

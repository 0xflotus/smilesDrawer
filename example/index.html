<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>SMILES Parser Demo</title>
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet">
    <script src="../dist/smiles-drawer.js"></script>
</head>

<body>
    <input id="input" type="text" class="parser" style="width: 490px; padding: 5px; border: 1px solid black; margin-bottom: 5px; font-size: 1.2em;" />
    <br />
    <canvas id="output-canvas" width="500" height="500"></canvas>
    <br />
    <div>
        <label><input id="debug" name="debug" type="checkbox">Debug</label>
    </div>
    <div>
        <label for="bondLength">Bond Length</label>
        <input type="range" id="bondLength" name="bondLength" value="16"
               min="1" max="99" step="1" />
    </div>
    <div>
        <label for="shortBondLength">Short Bond Length</label>
        <input type="range" id="shortBondLength" name="shortBondLength" value="9"
               min="1" max="22" step="1" />
    </div>
    <div>
        <label for="bondSpacing">Bond Spacing</label>
        <input type="range" id="bondSpacing" name="bondSpacing" value="4"
               min="1" max="99" step="1" />
    </div>
    <div>
        <label for="k">K</label>
        <input type="range" id="k" name="k" value="8"
               min="1" max="99" step="1" />
    </div>
    <script>
        var input = document.getElementById('input');
        var debugCheckbox = document.getElementById('debug');
        var bondLengthInput = document.getElementById('bondLength');
        var shortBondLengthInput = document.getElementById('shortBondLength');
        var bondSpacingInput = document.getElementById('bondSpacing');
        var kInput = document.getElementById('k');

        var options = { 
            debug: false,
            bondLength: 16,
            shortBondLength: 9,
            bondSpacing: 4,
            k: 8
        }

        var smilesDrawer = new SmilesDrawer(options);
        var input = document.getElementById('input');

        function draw() {
            let t = performance.now();
    
            SmilesDrawer.parse(input.value, function(tree) {
                smilesDrawer.draw(tree, 'output-canvas', 'light', false);
            });

            let td = performance.now() - t;

            console.log(td);
            console.log('Heavy Atom Count', smilesDrawer.getHeavyAtomCount());
        }

        function updateOptions() {
            smilesDrawer = new SmilesDrawer(options);
            draw();
        }

        document.addEventListener('DOMContentLoaded', function(event) {
            input.addEventListener('input', function() {
                draw();
            });

            debugCheckbox.addEventListener('click', function() {
               options.debug = debugCheckbox.checked ? true : false;
               updateOptions();
            });

            bondLengthInput.addEventListener('input', function() {
                options.bondLength = parseInt(bondLengthInput.value);
                shortBondLengthInput.max = options.bondLength;
                updateOptions();
            });

            shortBondLengthInput.addEventListener('input', function() {
                options.shortBondLength = parseInt(shortBondLengthInput.value);
                updateOptions();
            });

            bondSpacingInput.addEventListener('input', function() {
                options.bondSpacing = parseInt(bondSpacingInput.value);
                updateOptions();
            });

            kInput.addEventListener('input', function() {
                options.k = parseInt(kInput.value);
                updateOptions();
            });
        });
    </script>
</body>

</html>
